{"title":"Analyzing Carbon Footprints in SQL","markdown":{"yaml":{"title":"Analyzing Carbon Footprints in SQL"},"headingText":"Database contents","containsRefs":false,"markdown":"\n\n\n\n\n\n\n_Greenhouse gas emissions attributable to products&mdash;from food to sneakers to appliances&mdash;make up more than 75% of global emissions._\n\nCite: [The Carbon Catalogue](https://www.nature.com/articles/s41597-022-01178-9)\n\nThe dataset, which is publicly availably on [nature.com](https://www.nature.com/articles/s41597-022-01178-9), stores product carbon footprints (PCFs) for various companies. PCFs are the greenhouse gas emissions attributable to a given product, measured in CO2e (carbon dioxide equivalent).\n\n\nOur database contains one table, `product_emissions`, which looks at PCFs by product as well as the stage of production these emissions occured in.\n\n| field                              | data_type |\n|------------------------------------|-----------|\n| id                                 | VARCHAR   |\n| year                               | INT       |\n| product_name                       | VARCHAR   |\n| company                            | VARCHAR   |\n| country                            | VARCHAR   |\n| industry_group                     | VARCHAR   |\n| weight_kg                          | NUMERIC   |\n| carbon_footprint_pcf               | NUMERIC   |\n| upstream_percent_total_pcf         | VARCHAR   |\n| operations_percent_total_pcf       | VARCHAR   |\n| downstream_percent_total_pcf       | VARCHAR   |\n\n## 1: Coca-Cola's emissions\n\nFirst, let's look at a small subset of the data: emissions reported by Coca-Cola. Coke is actually made up of multiple companies around the globe, so we'll make sure our query returns data for any company name that starts with \"Coca-Cola\". Coke used to report for every single different product it has, so we will limit the results to six.\n\n- Select all fields from the `product_emissions` table where the company name begins with \"Coca-Cola\", limiting to the first six results.\n\n### A little background:\n- Upstream emissions: emissions that occur before the company's own operations such as emissions created by manufacturing bottles that Coke buys from suppliers\n- Operations emissions: emissions that the company creates directly, such as when Coke is bottling its product\n- Downstream emissions: emissions that occur after the product leaves the company, such as after Coke has sold drinks to McDonald's\n\n## 2: Most recent data\n\nWe'll focus on recent emissions data during this code-along. When was the most recent data collected?\n\n- Return the most recent year for which data was collected.\n\n## 3: Targeting major emitters\n\nWhat are the industries with the most emissions in 2017 (the most recent year that data is available)?\n\n- Return the `industry_group` and a rounded total of `carbon_footprint_pcf` for each industry, aliasing as `total_industry_footprint`.\n- Limit to data for 2017 and order by `total_industry_footprint`.\n\n## 4: Industry representation\n\nIt looks like the Materials industry had a huge carbon footprint in 2017. But what if that's just because there are many companies from the Materials industry in the dataset? Let's check which industries are most heavily represented in that year.\n\n- Return each `industry_group` included in the table and a count of the number of records that list that industry group.\n- Limit the results to only those from 2017 and lias the count as `count_industry`.\n- Order by `count_industry`, descending.\n\n## 5: Capital Goods industry\n\nWe can see that the Materials industry is the biggest emitter _despite_ having less representation in our dataset than several other industries&mdash;yikes! The Capital Goods industry looks similar. Let's explore the companies and products reporting for 2017 in the Capital Goods industry.\n\n- Return `industry_group`, `company`, and `product_name` for all records reporting in the Capital Goods industry during 2017.\n\n## 6: Capital Goods lifecycle emissions\n\nDaikin is an air conditioning and refrigeration manufacturer. Let's look at emissions throughout the life cycle of Daikin products. Can you guess whether most emissions are upstream, downstream, or during operations?\n\n- Return `product_name`, `company`, `upstream_percent_total_pcf`, `operations_percent_total_pcf`, and `downstream_percent_total_pcf` for Daikin Industries, Ltd. in 2017.\n\n## Exploring visually with plotly express\n\nLet's do some quick visualizations with `plotly.express`, a free an open-source graphing library. We don't assume any knowledge of `plotly` on your part!\n\n## 7: Country representation\n\nLet's take a look at emissions by country. You may have noticed that each time we run a query, the query results are available as `df`. So if we were to select all information from `product_emissions`, that would create a DataFrame called `df` that we can use in a `plotly` visualization! Let's try it.\n\n- Select all information from `product_emissions`.\n\nLet's look at country representation in our dataset by creating a bar chart using the `country` column of `df`.\n\n- Create a plotly bar chart of the country distribution for companies in our dataset.\n\n## 8: Emissions by country\n\nHow does this compare to the emissions of companies reporting from each country?\n\n- First, get the results of interest using SQL: grouping by country, select `country` and the sum of `total carbon_footprint_pcf` by country, aliasing as `total_country_footprint`.\n\n- Create a plotly bar plot of the emissions by country in our dataset.\n\n## 9: Does the graph above make sense?\n\nWow! Spain has a lot of emissions! Where do they come from? To finish our exploration together, let's take a quick look at the underlying data as a gut-check.\n\n- In SQL, select `company` and `carbon_footprint_pcf` for companies in Spain.\n\nGamesa Corporación Tecnológica is actually a renewable energy company specializing in wind power! Why might it have such high emissions? Discovering these twists in the data is very important before real analysis can begin. I hope you continue exploring this data on your own!\n","srcMarkdownNoYaml":"\n\n\n\n\n\n\n_Greenhouse gas emissions attributable to products&mdash;from food to sneakers to appliances&mdash;make up more than 75% of global emissions._\n\nCite: [The Carbon Catalogue](https://www.nature.com/articles/s41597-022-01178-9)\n\nThe dataset, which is publicly availably on [nature.com](https://www.nature.com/articles/s41597-022-01178-9), stores product carbon footprints (PCFs) for various companies. PCFs are the greenhouse gas emissions attributable to a given product, measured in CO2e (carbon dioxide equivalent).\n\n### Database contents\n\nOur database contains one table, `product_emissions`, which looks at PCFs by product as well as the stage of production these emissions occured in.\n\n| field                              | data_type |\n|------------------------------------|-----------|\n| id                                 | VARCHAR   |\n| year                               | INT       |\n| product_name                       | VARCHAR   |\n| company                            | VARCHAR   |\n| country                            | VARCHAR   |\n| industry_group                     | VARCHAR   |\n| weight_kg                          | NUMERIC   |\n| carbon_footprint_pcf               | NUMERIC   |\n| upstream_percent_total_pcf         | VARCHAR   |\n| operations_percent_total_pcf       | VARCHAR   |\n| downstream_percent_total_pcf       | VARCHAR   |\n\n## 1: Coca-Cola's emissions\n\nFirst, let's look at a small subset of the data: emissions reported by Coca-Cola. Coke is actually made up of multiple companies around the globe, so we'll make sure our query returns data for any company name that starts with \"Coca-Cola\". Coke used to report for every single different product it has, so we will limit the results to six.\n\n- Select all fields from the `product_emissions` table where the company name begins with \"Coca-Cola\", limiting to the first six results.\n\n### A little background:\n- Upstream emissions: emissions that occur before the company's own operations such as emissions created by manufacturing bottles that Coke buys from suppliers\n- Operations emissions: emissions that the company creates directly, such as when Coke is bottling its product\n- Downstream emissions: emissions that occur after the product leaves the company, such as after Coke has sold drinks to McDonald's\n\n## 2: Most recent data\n\nWe'll focus on recent emissions data during this code-along. When was the most recent data collected?\n\n- Return the most recent year for which data was collected.\n\n## 3: Targeting major emitters\n\nWhat are the industries with the most emissions in 2017 (the most recent year that data is available)?\n\n- Return the `industry_group` and a rounded total of `carbon_footprint_pcf` for each industry, aliasing as `total_industry_footprint`.\n- Limit to data for 2017 and order by `total_industry_footprint`.\n\n## 4: Industry representation\n\nIt looks like the Materials industry had a huge carbon footprint in 2017. But what if that's just because there are many companies from the Materials industry in the dataset? Let's check which industries are most heavily represented in that year.\n\n- Return each `industry_group` included in the table and a count of the number of records that list that industry group.\n- Limit the results to only those from 2017 and lias the count as `count_industry`.\n- Order by `count_industry`, descending.\n\n## 5: Capital Goods industry\n\nWe can see that the Materials industry is the biggest emitter _despite_ having less representation in our dataset than several other industries&mdash;yikes! The Capital Goods industry looks similar. Let's explore the companies and products reporting for 2017 in the Capital Goods industry.\n\n- Return `industry_group`, `company`, and `product_name` for all records reporting in the Capital Goods industry during 2017.\n\n## 6: Capital Goods lifecycle emissions\n\nDaikin is an air conditioning and refrigeration manufacturer. Let's look at emissions throughout the life cycle of Daikin products. Can you guess whether most emissions are upstream, downstream, or during operations?\n\n- Return `product_name`, `company`, `upstream_percent_total_pcf`, `operations_percent_total_pcf`, and `downstream_percent_total_pcf` for Daikin Industries, Ltd. in 2017.\n\n## Exploring visually with plotly express\n\nLet's do some quick visualizations with `plotly.express`, a free an open-source graphing library. We don't assume any knowledge of `plotly` on your part!\n\n## 7: Country representation\n\nLet's take a look at emissions by country. You may have noticed that each time we run a query, the query results are available as `df`. So if we were to select all information from `product_emissions`, that would create a DataFrame called `df` that we can use in a `plotly` visualization! Let's try it.\n\n- Select all information from `product_emissions`.\n\nLet's look at country representation in our dataset by creating a bar chart using the `country` column of `df`.\n\n- Create a plotly bar chart of the country distribution for companies in our dataset.\n\n## 8: Emissions by country\n\nHow does this compare to the emissions of companies reporting from each country?\n\n- First, get the results of interest using SQL: grouping by country, select `country` and the sum of `total carbon_footprint_pcf` by country, aliasing as `total_country_footprint`.\n\n- Create a plotly bar plot of the emissions by country in our dataset.\n\n## 9: Does the graph above make sense?\n\nWow! Spain has a lot of emissions! Where do they come from? To finish our exploration together, let's take a quick look at the underlying data as a gut-check.\n\n- In SQL, select `company` and `carbon_footprint_pcf` for companies in Spain.\n\nGamesa Corporación Tecnológica is actually a renewable energy company specializing in wind power! Why might it have such high emissions? Discovering these twists in the data is very important before real analysis can begin. I hope you continue exploring this data on your own!\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"brand":{"brand":{"typography":{"fonts":[{"family":"Jura","source":"google"}],"base":"Jura","headings":"Jura"}},"data":{"typography":{"fonts":[{"family":"Jura","source":"google"}],"base":"Jura","headings":"Jura"}},"brandDir":"C:\\Users\\Admin\\Desktop\\personal_projects\\Data_Analysis","projectDir":"C:\\Users\\Admin\\Desktop\\personal_projects\\Data_Analysis","processedData":{"color":{},"typography":{"base":"Jura","headings":"Jura"},"logo":{"images":{}}}}},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"notebook.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.40","jupyter":{"execute":{"execute_notebooks":false}},"grid":{"sidebar-width":"0px","body-width":"1100px","margin-width":"200px"},"theme":{"dark":"darkly","light":"flatly"},"title":"Analyzing Carbon Footprints in SQL"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}