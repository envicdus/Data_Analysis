<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analyzing Carbon Footprints in SQL – N. V. Decio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ac4524e5a9d5aa8c40839303379fa056.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-c6c198b56217c2f6773e825e44c457cc.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">N. V. Decio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Portfolios.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">Trainings.qmd</span>
    </span>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#database-contents" id="toc-database-contents" class="nav-link active" data-scroll-target="#database-contents">Database contents</a></li>
  <li><a href="#coca-colas-emissions" id="toc-coca-colas-emissions" class="nav-link" data-scroll-target="#coca-colas-emissions">1: Coca-Cola’s emissions</a>
  <ul class="collapse">
  <li><a href="#a-little-background" id="toc-a-little-background" class="nav-link" data-scroll-target="#a-little-background">A little background:</a></li>
  </ul></li>
  <li><a href="#most-recent-data" id="toc-most-recent-data" class="nav-link" data-scroll-target="#most-recent-data">2: Most recent data</a></li>
  <li><a href="#targeting-major-emitters" id="toc-targeting-major-emitters" class="nav-link" data-scroll-target="#targeting-major-emitters">3: Targeting major emitters</a></li>
  <li><a href="#industry-representation" id="toc-industry-representation" class="nav-link" data-scroll-target="#industry-representation">4: Industry representation</a></li>
  <li><a href="#capital-goods-industry" id="toc-capital-goods-industry" class="nav-link" data-scroll-target="#capital-goods-industry">5: Capital Goods industry</a></li>
  <li><a href="#capital-goods-lifecycle-emissions" id="toc-capital-goods-lifecycle-emissions" class="nav-link" data-scroll-target="#capital-goods-lifecycle-emissions">6: Capital Goods lifecycle emissions</a></li>
  <li><a href="#exploring-visually-with-plotly-express" id="toc-exploring-visually-with-plotly-express" class="nav-link" data-scroll-target="#exploring-visually-with-plotly-express">Exploring visually with plotly express</a></li>
  <li><a href="#country-representation" id="toc-country-representation" class="nav-link" data-scroll-target="#country-representation">7: Country representation</a></li>
  <li><a href="#emissions-by-country" id="toc-emissions-by-country" class="nav-link" data-scroll-target="#emissions-by-country">8: Emissions by country</a></li>
  <li><a href="#does-the-graph-above-make-sense" id="toc-does-the-graph-above-make-sense" class="nav-link" data-scroll-target="#does-the-graph-above-make-sense">9: Does the graph above make sense?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analyzing Carbon Footprints in SQL</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Greenhouse gas emissions attributable to products—from food to sneakers to appliances—make up more than 75% of global emissions.</em></p>
<p>Cite: <a href="https://www.nature.com/articles/s41597-022-01178-9">The Carbon Catalogue</a></p>
<p>The dataset, which is publicly availably on <a href="https://www.nature.com/articles/s41597-022-01178-9">nature.com</a>, stores product carbon footprints (PCFs) for various companies. PCFs are the greenhouse gas emissions attributable to a given product, measured in CO2e (carbon dioxide equivalent).</p>
<section id="database-contents" class="level3">
<h3 class="anchored" data-anchor-id="database-contents">Database contents</h3>
<p>Our database contains one table, <code>product_emissions</code>, which looks at PCFs by product as well as the stage of production these emissions occured in.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>field</th>
<th>data_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>VARCHAR</td>
</tr>
<tr class="even">
<td>year</td>
<td>INT</td>
</tr>
<tr class="odd">
<td>product_name</td>
<td>VARCHAR</td>
</tr>
<tr class="even">
<td>company</td>
<td>VARCHAR</td>
</tr>
<tr class="odd">
<td>country</td>
<td>VARCHAR</td>
</tr>
<tr class="even">
<td>industry_group</td>
<td>VARCHAR</td>
</tr>
<tr class="odd">
<td>weight_kg</td>
<td>NUMERIC</td>
</tr>
<tr class="even">
<td>carbon_footprint_pcf</td>
<td>NUMERIC</td>
</tr>
<tr class="odd">
<td>upstream_percent_total_pcf</td>
<td>VARCHAR</td>
</tr>
<tr class="even">
<td>operations_percent_total_pcf</td>
<td>VARCHAR</td>
</tr>
<tr class="odd">
<td>downstream_percent_total_pcf</td>
<td>VARCHAR</td>
</tr>
</tbody>
</table>
</section>
<section id="coca-colas-emissions" class="level2">
<h2 class="anchored" data-anchor-id="coca-colas-emissions">1: Coca-Cola’s emissions</h2>
<p>First, let’s look at a small subset of the data: emissions reported by Coca-Cola. Coke is actually made up of multiple companies around the globe, so we’ll make sure our query returns data for any company name that starts with “Coca-Cola”. Coke used to report for every single different product it has, so we will limit the results to six.</p>
<ul>
<li>Select all fields from the <code>product_emissions</code> table where the company name begins with “Coca-Cola”, limiting to the first six results.</li>
</ul>
<div id="8c0d794d-5929-429d-b02e-a8c90ee3c79d" class="cell" data-customtype="sql" data-dataframevariablename="df" data-executioncancelledat="null" data-executiontime="781" data-initial="false" data-integrationid="c632441c-e1dc-4637-a56d-10b85efd89be" data-lastexecutedat="1703156585466" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Select all fields where the company name is Coca-Cola, limiting to the first six results SELECT * FROM product_emissions WHERE company LIKE 'Coca-Cola%' LIMIT 6;" data-outputsmetadata="{&quot;0&quot;:{&quot;height&quot;:221,&quot;type&quot;:&quot;dataFrame&quot;}}" data-sqlcellmode="dataFrame" data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Select <span class="bu">all</span> fields where the company name <span class="kw">is</span> Coca<span class="op">-</span>Cola, limiting to the first six results</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>SELECT <span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>FROM product_emissions</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>WHERE company LIKE <span class="st">'Coca-Cola%'</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>LIMIT <span class="dv">6</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">product_name</th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">industry_group</th>
<th data-quarto-table-cell-role="th">weight_kg</th>
<th data-quarto-table-cell-role="th">carbon_footprint_pcf</th>
<th data-quarto-table-cell-role="th">upstream_percent_total_pcf</th>
<th data-quarto-table-cell-role="th">operations_percent_total_pcf</th>
<th data-quarto-table-cell-role="th">downstream_percent_total_pcf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>22710-1-2014</td>
<td>2014</td>
<td>Coca-Cola (all packaging and sizes)</td>
<td>Coca-Cola HBC AG</td>
<td>Switzerland</td>
<td>Food, Beverage &amp; Tobacco</td>
<td>1.093</td>
<td>0.1673</td>
<td>84.28%</td>
<td>11.12%</td>
<td>4.60%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>22710-1-2015</td>
<td>2015</td>
<td>Coca-Cola (all packaging and sizes)</td>
<td>Coca-Cola HBC AG</td>
<td>Switzerland</td>
<td>Food &amp; Beverage Processing</td>
<td>1.093</td>
<td>0.1580</td>
<td>38.37%</td>
<td>12.71%</td>
<td>48.93%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>22710-1-2016</td>
<td>2016</td>
<td>Coca-Cola (all packaging and sizes)</td>
<td>Coca-Cola HBC AG</td>
<td>Switzerland</td>
<td>Food, Beverage &amp; Tobacco</td>
<td>1.093</td>
<td>0.1470</td>
<td>42.17%</td>
<td>10.98%</td>
<td>46.85%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3565-10-2013</td>
<td>2013</td>
<td>Coke Zero 330 ml glass bottle</td>
<td>Coca-Cola Enterprises, Inc.</td>
<td>USA</td>
<td>Food, Beverage &amp; Tobacco</td>
<td>0.541</td>
<td>0.3400</td>
<td>73.95%</td>
<td>3.42%</td>
<td>22.63%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3565-11-2013</td>
<td>2013</td>
<td>Coke Zero 500ml PET</td>
<td>Coca-Cola Enterprises, Inc.</td>
<td>USA</td>
<td>Food, Beverage &amp; Tobacco</td>
<td>0.541</td>
<td>0.2200</td>
<td>52.09%</td>
<td>12.32%</td>
<td>35.59%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>3565-1-2013</td>
<td>2013</td>
<td>Coca-Cola 300ml can</td>
<td>Coca-Cola Enterprises, Inc.</td>
<td>USA</td>
<td>Food, Beverage &amp; Tobacco</td>
<td>0.300</td>
<td>0.1700</td>
<td>69.76%</td>
<td>7.00%</td>
<td>23.24%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="a-little-background" class="level3">
<h3 class="anchored" data-anchor-id="a-little-background">A little background:</h3>
<ul>
<li>Upstream emissions: emissions that occur before the company’s own operations such as emissions created by manufacturing bottles that Coke buys from suppliers</li>
<li>Operations emissions: emissions that the company creates directly, such as when Coke is bottling its product</li>
<li>Downstream emissions: emissions that occur after the product leaves the company, such as after Coke has sold drinks to McDonald’s</li>
</ul>
</section>
</section>
<section id="most-recent-data" class="level2">
<h2 class="anchored" data-anchor-id="most-recent-data">2: Most recent data</h2>
<p>We’ll focus on recent emissions data during this code-along. When was the most recent data collected?</p>
<ul>
<li>Return the most recent year for which data was collected.</li>
</ul>
<div id="6b076936-6acf-4785-ba69-bd478032dd2d" class="cell" data-customtype="sql" data-dataframevariablename="df" data-executioncancelledat="null" data-executiontime="770" data-initial="false" data-lastexecutedat="1703157070015" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Return the most recent year for which data was collected SELECT MAX(year) FROM product_emissions;" data-outputsmetadata="{&quot;0&quot;:{&quot;height&quot;:97,&quot;type&quot;:&quot;dataFrame&quot;}}" data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Return the most recent year <span class="cf">for</span> which data was collected</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>SELECT MAX(year)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>FROM product_emissions<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="targeting-major-emitters" class="level2">
<h2 class="anchored" data-anchor-id="targeting-major-emitters">3: Targeting major emitters</h2>
<p>What are the industries with the most emissions in 2017 (the most recent year that data is available)?</p>
<ul>
<li>Return the <code>industry_group</code> and a rounded total of <code>carbon_footprint_pcf</code> for each industry, aliasing as <code>total_industry_footprint</code>.</li>
<li>Limit to data for 2017 and order by <code>total_industry_footprint</code>.</li>
</ul>
<div id="2248db59-ba30-47a3-b10f-30078b5862cc" class="cell" data-customtype="sql" data-dataframevariablename="df" data-executioncancelledat="null" data-executiontime="873" data-initial="false" data-lastexecutedat="1703157919516" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Return industry_group and a rounded total of carbon_footprint_pcf, aliased as total_industry_footprint -- Limit to data for 2017 and order by total_industry_footprint SELECT industry_group, ROUND(SUM(carbon_footprint_pcf), 2) AS total_industry_footprint FROM product_emissions WHERE year = 2017 GROUP BY industry_group ORDER BY SUM(carbon_footprint_pcf) DESC;" data-outputsmetadata="{&quot;0&quot;:{&quot;height&quot;:221,&quot;type&quot;:&quot;dataFrame&quot;}}" data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Return industry_group <span class="kw">and</span> a rounded total of carbon_footprint_pcf, aliased <span class="im">as</span> total_industry_footprint</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Limit to data <span class="cf">for</span> <span class="dv">2017</span> <span class="kw">and</span> order by total_industry_footprint</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>SELECT industry_group, ROUND(SUM(carbon_footprint_pcf), <span class="dv">2</span>) AS total_industry_footprint</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>FROM product_emissions</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>WHERE year <span class="op">=</span> <span class="dv">2017</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>GROUP BY industry_group</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>ORDER BY SUM(carbon_footprint_pcf) DESC<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">industry_group</th>
<th data-quarto-table-cell-role="th">total_industry_footprint</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Materials</td>
<td>107129.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Capital Goods</td>
<td>94942.67</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Technology Hardware &amp; Equipment</td>
<td>21865.09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Food, Beverage &amp; Tobacco</td>
<td>3161.47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Commercial &amp; Professional Services</td>
<td>740.60</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Software &amp; Services</td>
<td>690.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="industry-representation" class="level2">
<h2 class="anchored" data-anchor-id="industry-representation">4: Industry representation</h2>
<p>It looks like the Materials industry had a huge carbon footprint in 2017. But what if that’s just because there are many companies from the Materials industry in the dataset? Let’s check which industries are most heavily represented in that year.</p>
<ul>
<li>Return each <code>industry_group</code> included in the table and a count of the number of records that list that industry group.</li>
<li>Limit the results to only those from 2017 and lias the count as <code>count_industry</code>.</li>
<li>Order by <code>count_industry</code>, descending.</li>
</ul>
<div id="e77a78ea-1a92-4a06-9d4e-41b25d7be93d" class="cell" data-customtype="sql" data-dataframevariablename="df" data-executioncancelledat="null" data-executiontime="716" data-initial="false" data-lastexecutedat="1703158946545" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Return the industry groups and a count of the number of records for each group -- Limit the results to only those from 2017 and alias the count as count_industry -- Order by count_industry, descending SELECT industry_group, COUNT(*) AS count_industry FROM public.product_emissions WHERE year = 2017 GROUP BY industry_group ORDER BY COUNT(industry_group) DESC;" data-outputsmetadata="{&quot;0&quot;:{&quot;height&quot;:221,&quot;type&quot;:&quot;dataFrame&quot;}}" data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Return the industry groups <span class="kw">and</span> a count of the number of records <span class="cf">for</span> each group</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Limit the results to only those <span class="im">from</span> <span class="dv">2017</span> <span class="kw">and</span> alias the count <span class="im">as</span> count_industry</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Order by count_industry, descending</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>SELECT industry_group, COUNT(<span class="op">*</span>) AS count_industry</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>FROM public.product_emissions</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>WHERE year <span class="op">=</span> <span class="dv">2017</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>GROUP BY industry_group</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ORDER BY COUNT(industry_group) DESC<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">industry_group</th>
<th data-quarto-table-cell-role="th">count_industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Technology Hardware &amp; Equipment</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Food, Beverage &amp; Tobacco</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Materials</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Capital Goods</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Commercial &amp; Professional Services</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Software &amp; Services</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="capital-goods-industry" class="level2">
<h2 class="anchored" data-anchor-id="capital-goods-industry">5: Capital Goods industry</h2>
<p>We can see that the Materials industry is the biggest emitter <em>despite</em> having less representation in our dataset than several other industries—yikes! The Capital Goods industry looks similar. Let’s explore the companies and products reporting for 2017 in the Capital Goods industry.</p>
<ul>
<li>Return <code>industry_group</code>, <code>company</code>, and <code>product_name</code> for all records reporting in the Capital Goods industry during 2017.</li>
</ul>
<div id="d416ca64-4101-4263-b513-ebfeb72fffca" class="cell" data-customtype="sql" data-dataframevariablename="df" data-executioncancelledat="null" data-executiontime="792" data-initial="false" data-lastexecutedat="1703159239429" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Return industry_group, company, and product_name for all records reporting in the Capital Goods industry during 2017 SELECT industry_group, company, product_name FROM public.product_emissions WHERE industry_group = 'Capital Goods' and year = 2017; " data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Return industry_group, company, <span class="kw">and</span> product_name <span class="cf">for</span> <span class="bu">all</span> records reporting <span class="kw">in</span> the Capital Goods industry during <span class="dv">2017</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>SELECT industry_group, company, product_name</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>FROM public.product_emissions</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>WHERE industry_group <span class="op">=</span> <span class="st">'Capital Goods'</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">and</span> year <span class="op">=</span> <span class="dv">2017</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">industry_group</th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">product_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Capital Goods</td>
<td>Mitsui Mining &amp; Smelting Co., Ltd.</td>
<td>Zinc Oxide</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Capital Goods</td>
<td>Daikin Industries, Ltd.</td>
<td>Residential Air Conditioner</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Capital Goods</td>
<td>Daikin Industries, Ltd.</td>
<td>Commercial Air Conditioner</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Capital Goods</td>
<td>Daikin Industries, Ltd.</td>
<td>Light commercial Air Conditioner</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="capital-goods-lifecycle-emissions" class="level2">
<h2 class="anchored" data-anchor-id="capital-goods-lifecycle-emissions">6: Capital Goods lifecycle emissions</h2>
<p>Daikin is an air conditioning and refrigeration manufacturer. Let’s look at emissions throughout the life cycle of Daikin products. Can you guess whether most emissions are upstream, downstream, or during operations?</p>
<ul>
<li>Return <code>product_name</code>, <code>company</code>, <code>upstream_percent_total_pcf</code>, <code>operations_percent_total_pcf</code>, and <code>downstream_percent_total_pcf</code> for Daikin Industries, Ltd.&nbsp;in 2017.</li>
</ul>
<div id="c8ee870d-836a-4f22-8abd-e078e0464b73" class="cell" data-customtype="sql" data-dataframevariablename="df" data-executioncancelledat="null" data-executiontime="644" data-initial="false" data-lastexecutedat="1703159455882" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Return product_name, company, and all stages of pcf emissions for Daikin in 2017 SELECT product_name,      company,     upstream_percent_total_pcf,      operations_percent_total_pcf,      downstream_percent_total_pcf FROM public.product_emissions WHERE year = 2017     and company = 'Daikin Industries, Ltd.' " data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Return product_name, company, <span class="kw">and</span> <span class="bu">all</span> stages of pcf emissions <span class="cf">for</span> Daikin <span class="kw">in</span> <span class="dv">2017</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>SELECT product_name, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    company,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    upstream_percent_total_pcf, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    operations_percent_total_pcf, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    downstream_percent_total_pcf</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>FROM public.product_emissions</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>WHERE year <span class="op">=</span> <span class="dv">2017</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">and</span> company <span class="op">=</span> <span class="st">'Daikin Industries, Ltd.'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">product_name</th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">upstream_percent_total_pcf</th>
<th data-quarto-table-cell-role="th">operations_percent_total_pcf</th>
<th data-quarto-table-cell-role="th">downstream_percent_total_pcf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Residential Air Conditioner</td>
<td>Daikin Industries, Ltd.</td>
<td>3.96%</td>
<td>0.55%</td>
<td>95.50%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Commercial Air Conditioner</td>
<td>Daikin Industries, Ltd.</td>
<td>0.98%</td>
<td>0.13%</td>
<td>98.88%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Light commercial Air Conditioner</td>
<td>Daikin Industries, Ltd.</td>
<td>0.70%</td>
<td>0.10%</td>
<td>99.21%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="exploring-visually-with-plotly-express" class="level2">
<h2 class="anchored" data-anchor-id="exploring-visually-with-plotly-express">Exploring visually with plotly express</h2>
<p>Let’s do some quick visualizations with <code>plotly.express</code>, a free an open-source graphing library. We don’t assume any knowledge of <code>plotly</code> on your part!</p>
<div id="2eb60e3c" class="cell" data-executioncancelledat="null" data-executiontime="184" data-lastexecutedat="1703159562924" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="# Import the plotly express package import plotly.express as px" data-execution_count="15">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the plotly express package</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="country-representation" class="level2">
<h2 class="anchored" data-anchor-id="country-representation">7: Country representation</h2>
<p>Let’s take a look at emissions by country. You may have noticed that each time we run a query, the query results are available as <code>df</code>. So if we were to select all information from <code>product_emissions</code>, that would create a DataFrame called <code>df</code> that we can use in a <code>plotly</code> visualization! Let’s try it.</p>
<ul>
<li>Select all information from <code>product_emissions</code>.</li>
</ul>
<div id="c4710f20-7844-477d-ae8f-28b2689e86d6" class="cell" data-customtype="sql" data-dataframevariablename="product_emission_df" data-executioncancelledat="null" data-executiontime="890" data-initial="false" data-lastexecutedat="1703159919489" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Select all information from product_emissions SELECT * FROM product_emissions;" data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Select <span class="bu">all</span> information <span class="im">from</span> product_emissions</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>SELECT <span class="op">*</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>FROM product_emissions<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">product_name</th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">industry_group</th>
<th data-quarto-table-cell-role="th">weight_kg</th>
<th data-quarto-table-cell-role="th">carbon_footprint_pcf</th>
<th data-quarto-table-cell-role="th">upstream_percent_total_pcf</th>
<th data-quarto-table-cell-role="th">operations_percent_total_pcf</th>
<th data-quarto-table-cell-role="th">downstream_percent_total_pcf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10056-1-2014</td>
<td>2014</td>
<td>Frosted Flakes(R) Cereal</td>
<td>Kellogg Company</td>
<td>USA</td>
<td>Food, Beverage &amp; Tobacco</td>
<td>0.748500</td>
<td>2.00</td>
<td>57.50%</td>
<td>30.00%</td>
<td>12.50%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10056-1-2015</td>
<td>2015</td>
<td>Frosted Flakes, 23 oz, produced in Lancaster, ...</td>
<td>Kellogg Company</td>
<td>USA</td>
<td>Food &amp; Beverage Processing</td>
<td>0.748500</td>
<td>2.00</td>
<td>57.50%</td>
<td>30.00%</td>
<td>12.50%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>10222-1-2013</td>
<td>2013</td>
<td>Office Chair</td>
<td>KNOLL INC</td>
<td>USA</td>
<td>Capital Goods</td>
<td>20.680000</td>
<td>72.54</td>
<td>80.63%</td>
<td>17.36%</td>
<td>2.01%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>10261-1-2017</td>
<td>2017</td>
<td>Multifunction Printers</td>
<td>Konica Minolta, Inc.</td>
<td>Japan</td>
<td>Technology Hardware &amp; Equipment</td>
<td>110.000000</td>
<td>1488.00</td>
<td>30.65%</td>
<td>5.51%</td>
<td>63.84%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>10261-2-2017</td>
<td>2017</td>
<td>Multifunction Printers</td>
<td>Konica Minolta, Inc.</td>
<td>Japan</td>
<td>Technology Hardware &amp; Equipment</td>
<td>110.000000</td>
<td>1818.00</td>
<td>25.08%</td>
<td>4.51%</td>
<td>70.41%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">861</td>
<td>9298-2-2014</td>
<td>2014</td>
<td>Desktop CPU</td>
<td>Intel Corporation</td>
<td>USA</td>
<td>Semiconductors &amp; Semiconductor Equipment</td>
<td>0.408233</td>
<td>14.00</td>
<td>32.14%</td>
<td>54.29%</td>
<td>13.57%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">862</td>
<td>9298-3-2013</td>
<td>2013</td>
<td>Mobile CPU</td>
<td>Intel Corporation</td>
<td>USA</td>
<td>Technology Hardware &amp; Equipment</td>
<td>0.408233</td>
<td>7.00</td>
<td>28.57%</td>
<td>71.43%</td>
<td>0.00%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">863</td>
<td>9298-3-2014</td>
<td>2014</td>
<td>Mobile CPU</td>
<td>Intel Corporation</td>
<td>USA</td>
<td>Semiconductors &amp; Semiconductor Equipment</td>
<td>0.408233</td>
<td>7.00</td>
<td>31.43%</td>
<td>54.29%</td>
<td>14.29%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">864</td>
<td>9792-1-2017</td>
<td>2017</td>
<td>Complete catalyst system for diesel-powered pa...</td>
<td>Johnson Matthey</td>
<td>United Kingdom</td>
<td>Materials</td>
<td>2.000000</td>
<td>188.00</td>
<td>N/a (product with insufficient stage-level data)</td>
<td>N/a (product with insufficient stage-level data)</td>
<td>N/a (product with insufficient stage-level data)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">865</td>
<td>9792-2-2017</td>
<td>2017</td>
<td>Three-way Catalyst for gasoline-powered passen...</td>
<td>Johnson Matthey</td>
<td>United Kingdom</td>
<td>Materials</td>
<td>2.000000</td>
<td>63.00</td>
<td>N/a (product with insufficient stage-level data)</td>
<td>N/a (product with insufficient stage-level data)</td>
<td>N/a (product with insufficient stage-level data)</td>
</tr>
</tbody>
</table>

<p>866 rows × 11 columns</p>
</div>
</div>
</div>
<p>Let’s look at country representation in our dataset by creating a bar chart using the <code>country</code> column of <code>df</code>.</p>
<ul>
<li>Create a plotly bar chart of the country distribution for companies in our dataset.</li>
</ul>
<div id="d3f89cb6" class="cell" data-executioncancelledat="null" data-executiontime="225" data-lastexecutedat="1703159951647" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="# Create a plotly bar chart of the country distribution for companies in our dataset px.bar(product_emission_df, x=&quot;country&quot;)" data-execution_count="18">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a plotly bar chart of the country distribution for companies in our dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>px.bar(product_emission_df, x<span class="op">=</span><span class="st">"country"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
</section>
<section id="emissions-by-country" class="level2">
<h2 class="anchored" data-anchor-id="emissions-by-country">8: Emissions by country</h2>
<p>How does this compare to the emissions of companies reporting from each country?</p>
<ul>
<li>First, get the results of interest using SQL: grouping by country, select <code>country</code> and the sum of <code>total carbon_footprint_pcf</code> by country, aliasing as <code>total_country_footprint</code>.</li>
</ul>
<div id="b2888658-0cb6-402c-a4d1-06492762a2f1" class="cell" data-customtype="sql" data-dataframevariablename="df" data-executioncancelledat="null" data-executiontime="702" data-initial="false" data-lastexecutedat="1703160134155" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Group by country -- Select country and the sum of total carbon_footprint_pcf by country, aliasing as total_country_footprint SELECT country, SUM(carbon_footprint_pcf) AS total_country_footprint FROM product_emissions GROUP BY country;" data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Group by country</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Select country <span class="kw">and</span> the <span class="bu">sum</span> of total carbon_footprint_pcf by country, aliasing <span class="im">as</span> total_country_footprint</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>SELECT country, SUM(carbon_footprint_pcf) AS total_country_footprint</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>FROM product_emissions</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>GROUP BY country<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">total_country_footprint</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Indonesia</td>
<td>7.210000e+02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Switzerland</td>
<td>1.406263e+02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Italy</td>
<td>1.940500e+01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>China</td>
<td>1.425430e+02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Luxembourg</td>
<td>1.670073e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Sweden</td>
<td>4.533010e+03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>USA</td>
<td>4.518692e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>United Kingdom</td>
<td>6.735140e+03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Netherlands</td>
<td>7.041534e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Brazil</td>
<td>1.675877e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Australia</td>
<td>2.384670e+02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Germany</td>
<td>2.251225e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Ireland</td>
<td>5.130000e+03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Canada</td>
<td>3.822000e+02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Finland</td>
<td>2.158100e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>South Korea</td>
<td>1.409941e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Colombia</td>
<td>8.300000e-04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Lithuania</td>
<td>1.080000e-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Spain</td>
<td>9.786126e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Greece</td>
<td>7.000000e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>India</td>
<td>2.457400e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Belgium</td>
<td>9.400000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Chile</td>
<td>1.555600e+03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>France</td>
<td>1.613803e+03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>South Africa</td>
<td>1.231090e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Malaysia</td>
<td>2.336700e+02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Taiwan</td>
<td>6.151307e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Japan</td>
<td>5.193443e+05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Create a plotly bar plot of the emissions by country in our dataset.</li>
</ul>
<div id="60c9b97e-740c-4a3d-8c1a-5e18917732d0" class="cell" data-executioncancelledat="null" data-executiontime="50" data-lastexecutedat="1703160335119" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="# Create a plotly bar plot of the emissions by country in our dataset px.bar(df, x=&quot;country&quot;, y=&quot;total_country_footprint&quot;)" data-outputsmetadata="{&quot;0&quot;:{&quot;height&quot;:467,&quot;type&quot;:&quot;plotly&quot;}}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a plotly bar plot of the emissions by country in our dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>px.bar(df, x<span class="op">=</span><span class="st">"country"</span>, y<span class="op">=</span><span class="st">"total_country_footprint"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
</section>
<section id="does-the-graph-above-make-sense" class="level2">
<h2 class="anchored" data-anchor-id="does-the-graph-above-make-sense">9: Does the graph above make sense?</h2>
<p>Wow! Spain has a lot of emissions! Where do they come from? To finish our exploration together, let’s take a quick look at the underlying data as a gut-check.</p>
<ul>
<li>In SQL, select <code>company</code> and <code>carbon_footprint_pcf</code> for companies in Spain.</li>
</ul>
<div id="9c124563-179c-4150-bc0d-3b3b27c20a08" class="cell" data-customtype="sql" data-dataframevariablename="df" data-executioncancelledat="null" data-executiontime="792" data-initial="false" data-lastexecutedat="1703160446332" data-lastscheduledrunid="null" data-lastsuccessfullyexecutedcode="-- Select company and carbon_footprint_pcf for companies in Spain SELECT company, carbon_footprint_pcf FROM public.product_emissions WHERE country = 'Spain';" data-sqlsource="{&quot;integrationId&quot;:&quot;d18487fc-f696-400e-9e4c-0f43e1918aaa&quot;,&quot;integrationType&quot;:&quot;postgresql&quot;,&quot;type&quot;:&quot;integration&quot;}" data-execution_count="22">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">--</span> Select company <span class="kw">and</span> carbon_footprint_pcf <span class="cf">for</span> companies <span class="kw">in</span> Spain</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>SELECT company, carbon_footprint_pcf</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>FROM public.product_emissions</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>WHERE country <span class="op">=</span> <span class="st">'Spain'</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">carbon_footprint_pcf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Miquel Y Costas</td>
<td>3.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Gamesa Corporación Tecnológica, S.A.</td>
<td>1251625.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Gamesa Corporación Tecnológica, S.A.</td>
<td>1532608.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Gamesa Corporación Tecnológica, S.A.</td>
<td>3718044.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Gamesa Corporación Tecnológica, S.A.</td>
<td>3276187.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Compañía Española de Petróleos, S.A.U. CEPSA</td>
<td>6109.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Compañía Española de Petróleos, S.A.U. CEPSA</td>
<td>890.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Crimidesa</td>
<td>180.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Crimidesa</td>
<td>140.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Agraz</td>
<td>155.71</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Agraz</td>
<td>12.52</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Agraz</td>
<td>155.78</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Agraz</td>
<td>16.22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Gamesa Corporación Tecnológica is actually a renewable energy company specializing in wind power! Why might it have such high emissions? Discovering these twists in the data is very important before real analysis can begin. I hope you continue exploring this data on your own!</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Neil Vince Decio</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/envicdus/Data_Analysis/tree/main">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/nvddecio/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>